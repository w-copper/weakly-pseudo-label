stages:
  -
    type: train_refine
    model:
      type:
      backbone:
        type: VGG
        cfg: '11'
        pretrain: False
      cam_head:
        type: AttentionMap
        inc: 512
        num_class: 5
      refine:
        type: SEAM
        img_c: 3
        feature1_c: 256
        feature2_c: 512
        scale: 0.3
    data:
      type:
      train:
        type: Dataset
        file_list: configs/data/train_cls.txt
        img_dir: D:/data/GID/ws/images
        ann_dir: null
        cam_dir: null
        out_dir: D:/data/GID/ws/test
        num_class: 5
        pipelines:
          -
            type: LoadImage
            bands: [0,1,2]
          -
            type: Normalize
            mean: [122.675, 116.669, 104.008]
            std: [1.0, 1.0, 1.0]
          -
            type: ToTensor
      train_loader:
        batch_size: 8
      val:
        type: Dataset
        file_list: configs/data/train_cls.txt
        img_dir: D:/data/GID/ws/images
        ann_dir: null
        cam_dir: null
        out_dir: D:/data/GID/ws/test
        num_class: 5
        pipelines:
          -
            type: LoadImage
            bands: [0,1,2]
          -
            type: Normalize
            mean: [122.675, 116.669, 104.008]
            std: [1.0, 1.0, 1.0]
          -
            type: ToTensor
      val_loader:
        batch_size: 8
    optim:
      type: PolyOptimizer
      lr: 0.001
      weight_decay: 0.9
      max_step: 2000
    runner:
      checkpoint_callback: True
      gpus: '0'
      log_gpu_memory: True
      max_steps: 3000
      logger: True
      default_root_dir: lightning_logs/seam_vgg11_test
  -
    type: infer_refine
    model:
      type: pre
    data:
      test:
        type: Dataset
        file_list: configs/data/train_cls.txt
        img_dir: D:/data/GID/ws/images
        ann_dir: null
        cam_dir: null
        out_dir: D:/data/GID/ws/test
        num_class: 5
        pipelines:
          -
            type: LoadImage
            bands: [0,1,2]
          -
            type: Normalize
            mean: [122.675, 116.669, 104.008]
            std: [1.0, 1.0, 1.0]
          -
            type: ToTensor
      test_loader:
        batch_size: 8
    runner:
      gpus: '0'
      log_gpu_memory: True
      max_epochs: 1
      logger: True
      default_root_dir: lightning_logs/seam_vgg11_test